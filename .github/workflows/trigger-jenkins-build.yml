# Licensed to the Apache Software Foundation (ASF) under one
# or more contributor license agreements.  See the NOTICE file
# distributed with this work for additional information
# regarding copyright ownership.  The ASF licenses this file
# to you under the Apache License, Version 2.0 (the
# "License"); you may not use this file except in compliance
# with the License.  You may obtain a copy of the License at
#
#   http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing,
# software distributed under the License is distributed on an
# "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
# KIND, either express or implied.  See the License for the
# specific language governing permissions and limitations
# under the License.
name: Trigger Jenkins Build

on:
  issue_comment:
    types: [created]

jobs:
 trigger-jenkins-test:
   if: contains(github.event.comment.html_url, '/pull/')
   runs-on: ubuntu-latest
   steps:
    - name: Trigger Jenkins Test
      if: startsWith(github.event.comment.body, '\test')
      run: |
       echo say hello
       JENKINS_URL=https://ci.mlc.ai/job/mlc/
       JENKINS_USER=junrushao
       JENKINS_TOKEN=119c459c1b1c53d0e584cbaabe9e2de2cc
       JENKINS_JOB=$JENKINS_URL/job/PR-${{ github.event.pull_request.number }}
       BUILD_NUMBER=$(curl -s -X GET $JENKINS_JOB/lastBuild/buildNumber)
       curl -X POST -u $JENKINS_USER:$JENKINS_TOKEN $JENKINS_JOB/$BUILD_NUMBER/input/1/proceedEmpty

